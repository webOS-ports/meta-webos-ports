From 974744ca91ab338d192ab916128ccbcf96cd5300 Mon Sep 17 00:00:00 2001
From: Martin Jansa <Martin.Jansa@gmail.com>
Date: Wed, 16 May 2018 08:28:09 +0000
Subject: [PATCH] GLcommon: add dependency on GLHeaders

* otherwise it might fail to build with:
FAILED: external/android-emugl/host/libs/Translator/GLcommon/CMakeFiles/GLcommon.dir/GLDispatch.cpp.o
/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/recipe-sysroot-native/usr/bin/x86_64-webos-linux/x86_64-webos-linux-g++   -Iexternal/android-emugl/host/libs/Translator/GLcommon -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/libs/Translator/GLcommon -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/src -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/shared -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/include -Iexternal/android-emugl/host/include -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/shared/OpenglCodecCommon -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/libs -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/include/libOpenglRender -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/libs/GLESv1_dec -Iexternal/android-emugl/host/libs/GLESv1_dec -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/libs/GLESv2_dec -Iexternal/android-emugl/host/libs/GLESv2_dec -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/libs/renderControl_dec -Iexternal/android-emugl/host/libs/renderControl_dec -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/libs/Translator -I/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/libs/Translator/include -m64 -march=core2 -mtune=core2 -msse3 -mfpmath=sse  --sysroot=/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/recipe-sysroot  -O2 -pipe -g -feliminate-unused-debug-types -fdebug-prefix-map=/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0=/usr/src/debug/anbox/3.0+gitrAUTOINC+4a5cb84231-r0 -fdebug-prefix-map=/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/recipe-sysroot= -fdebug-prefix-map=/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/recipe-sysroot-native=  -fvisibility-inlines-hidden  -m64 -march=core2 -mtune=core2 -msse3 -mfpmath=sse  --sysroot=/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/recipe-sysroot -fvisibility=default -std=c++11 -pedantic -Wall -Wextra -Wcast-align -Wcast-qual -Wformat -Wredundant-decls -Wswitch-default -Wnon-virtual-dtor -Wold-style-cast -fno-permissive -std=c++14 -fPIC -DTRANSLATOR_INSTALL_DIR=\"/usr/lib/anbox/translators\" -g -fPIC -MD -MT external/android-emugl/host/libs/Translator/GLcommon/CMakeFiles/GLcommon.dir/GLDispatch.cpp.o -MF external/android-emugl/host/libs/Translator/GLcommon/CMakeFiles/GLcommon.dir/GLDispatch.cpp.o.d -o external/android-emugl/host/libs/Translator/GLcommon/CMakeFiles/GLcommon.dir/GLDispatch.cpp.o -c /OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/libs/Translator/GLcommon/GLDispatch.cpp
In file included from /OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/libs/Translator/include/GLcommon/GLDispatch.h:23,
                 from /OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/libs/Translator/GLcommon/GLDispatch.cpp:17:
/OE/build/owpb/webos-ports/tmp-glibc/work/core2-64-webos-linux/anbox/3.0+gitrAUTOINC+4a5cb84231-r0/git/external/android-emugl/host/include/OpenGLESDispatch/gles_functions.h:17:10: fatal error: OpenGLESDispatch/gles_common_functions.h: No such file or directory
 #include "OpenGLESDispatch/gles_common_functions.h"
          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Signed-off-by: Martin Jansa <Martin.Jansa@gmail.com>
---
 .../android-emugl/host/libs/Translator/GLcommon/CMakeLists.txt   | 1 +
 1 file changed, 1 insertion(+)

diff --git a/external/android-emugl/host/libs/Translator/GLcommon/CMakeLists.txt b/external/android-emugl/host/libs/Translator/GLcommon/CMakeLists.txt
index 9f553f9..fb9f41c 100644
--- a/external/android-emugl/host/libs/Translator/GLcommon/CMakeLists.txt
+++ b/external/android-emugl/host/libs/Translator/GLcommon/CMakeLists.txt
@@ -13,5 +13,6 @@ set(SOURCES
     FramebufferData.cpp)
 
 add_library(GLcommon STATIC ${SOURCES})
+add_dependencies(GLcommon GLHeaders)
 target_link_libraries(GLcommon
     emugl_common)
-- 
2.17.0


From c74e2c48c22e37ec6005ee9f3ec5a768742b953a Mon Sep 17 00:00:00 2001
From: Martin Jansa <martin2.jansa@lgepartner.com>
Date: Wed, 1 Feb 2023 22:41:55 +0000
Subject: [PATCH] Fix build with gcc-13

:Release Notes:

:Detailed Notes:
Fixes:
http://gecko.lge.com/Errors/Details/529519

FAILED: CMakeFiles/webos-bluetooth-service.dir/src/bluetoothbinarysocket.cpp.o
TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot-native/usr/bin/x86_64-webos-linux/x86_64-webos-linux-g++ -DWBS_LOCAL_SERVICE -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/lib/glib-2.0/include -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/include/libmount -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/include/blkid -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/include/gio-unix-2.0 -m64 -march=core2 -mtune=core2 -msse3 -mfpmath=sse -fstack-protector-strong  -O2 -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -Werror=return-type  --sysroot=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot  -O2 -pipe -g -feliminate-unused-debug-types -fmacro-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/git=/usr/src/debug/com.webos.service.bluetooth2/1.0.0-71-r6  -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/git=/usr/src/debug/com.webos.service.bluetooth2/1.0.0-71-r6  -fmacro-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/build=/usr/src/debug/com.webos.service.bluetooth2/1.0.0-71-r6  -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/build=/usr/src/debug/com.webos.service.bluetooth2/1.0.0-71-r6  -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot=  -fmacro-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot=  -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot-native=  -fvisibility-inlines-hidden  -std=c++11 -Wall -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/lib/glib-2.0/include -pthread -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/include/libmount -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/include/blkid -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/lib/glib-2.0/include -pthread -DUSE_PMLOG_DECLARATION -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/recipe-sysroot/usr/lib/glib-2.0/include -ITOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/build/Configured/src -Wl,--no-undefined -DNDEBUG -MD -MT CMakeFiles/webos-bluetooth-service.dir/src/bluetoothbinarysocket.cpp.o -MF CMakeFiles/webos-bluetooth-service.dir/src/bluetoothbinarysocket.cpp.o.d -o CMakeFiles/webos-bluetooth-service.dir/src/bluetoothbinarysocket.cpp.o -c TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/git/src/bluetoothbinarysocket.cpp
In file included from TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/git/src/bluetoothbinarysocket.cpp:18:
TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/git/src/bluetoothbinarysocket.h:53:29: error: 'uint8_t' does not name a type
   53 |         bool sendData(const uint8_t *data, const uint32_t size);
      |                             ^~~~~~~
TOPDIR/BUILD/work/qemux86_64-webos-linux/com.webos.service.bluetooth2/1.0.0-71-r6/git/src/bluetoothbinarysocket.h:29:1: note: 'uint8_t' is defined in header '<cstdint>'; did you forget to '#include <cstdint>'?
   28 | #include <gio/gio.h>
  +++ |+#include <cstdint>
   29 | #include <glib-object.h>

:Testing Performed:
Only build tested.

:QA Notes:
No change to image.

:Issues Addressed:
[WRP-8053] CCC: Various build fixes

Change-Id: I3e6849a617d146a61e5d54eafe0c7cc1d7f12175
---
Upstream-Status: Submitted [http://gpro.lge.com/c/webosose/com.webos.service.bluetooth2/+/344557 Fix build with gcc-13]

 src/bluetoothbinarysocket.h | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/bluetoothbinarysocket.h b/src/bluetoothbinarysocket.h
index 643e848..f4aa41e 100644
--- a/src/bluetoothbinarysocket.h
+++ b/src/bluetoothbinarysocket.h
@@ -18,6 +18,7 @@
 #ifndef BLUETOOTHBINARYSOCKET_H
 #define BLUETOOTHBINARYSOCKET_H
 
+#include <cstdint>
 #include <string>
 #include <functional>
 #include <sys/socket.h>

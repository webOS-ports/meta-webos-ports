From f4b4cd1f4399455eea2a3fa40b58ca7ffee59c83 Mon Sep 17 00:00:00 2001
From: Christophe Chapuis <chris.chapuis@gmail.com>
Date: Tue, 12 Apr 2022 18:18:48 +0000
Subject: [PATCH 3/6] WebOS Shell Surface: add client_size_changed wayland
 event

Signed-off-by: Christophe Chapuis <chris.chapuis@gmail.com>
---
 src/ozone/wayland/shell/webos_shell_surface.cc           | 7 +++++++
 src/ozone/wayland/shell/webos_shell_surface.h            | 6 ++++++
 .../extensions/webos/host/webos_shell_surface_wrapper.cc | 9 +++++++++
 .../extensions/webos/host/webos_shell_surface_wrapper.h  | 5 +++++
 4 files changed, 27 insertions(+)

diff --git a/src/ozone/wayland/shell/webos_shell_surface.cc b/src/ozone/wayland/shell/webos_shell_surface.cc
index 5eb6e10852..bdc7c3d2e5 100644
--- a/src/ozone/wayland/shell/webos_shell_surface.cc
+++ b/src/ozone/wayland/shell/webos_shell_surface.cc
@@ -112,6 +112,7 @@ void WebosShellSurface::InitializeShellSurface(WaylandWindow* window,
   static const wl_webos_shell_surface_listener webos_shell_surface_listener = {
       WebosShellSurface::HandleStateChanged,
       WebosShellSurface::HandlePositionChanged,
+      WebosShellSurface::HandleClientSizeChanged,
       WebosShellSurface::HandleClose,
       WebosShellSurface::HandleExposed,
       WebosShellSurface::HandleStateAboutToChange};
@@ -261,6 +262,12 @@ void WebosShellSurface::HandlePositionChanged(
     int32_t x,
     int32_t y) {}
 
+void WebosShellSurface::HandleClientSizeChanged(
+    void* data,
+    struct wl_webos_shell_surface* webos_shell_surface,
+    int32_t width,
+    int32_t height) {}
+
 void WebosShellSurface::HandleClose(
     void* data,
     struct wl_webos_shell_surface* webos_shell_surface) {
diff --git a/src/ozone/wayland/shell/webos_shell_surface.h b/src/ozone/wayland/shell/webos_shell_surface.h
index 7684b7c34d..1635204b3e 100644
--- a/src/ozone/wayland/shell/webos_shell_surface.h
+++ b/src/ozone/wayland/shell/webos_shell_surface.h
@@ -62,6 +62,12 @@ class WebosShellSurface : public WLShellSurface {
       int32_t x,
       int32_t y);
 
+  static void HandleClientSizeChanged(
+      void* data,
+      struct wl_webos_shell_surface* webos_shell_surface,
+      int32_t width,
+      int32_t height);
+
   static void HandleClose(void* data,
                           struct wl_webos_shell_surface* webos_shell_surface);
 
diff --git a/src/ui/ozone/platform/wayland/extensions/webos/host/webos_shell_surface_wrapper.cc b/src/ui/ozone/platform/wayland/extensions/webos/host/webos_shell_surface_wrapper.cc
index 9a8cfa6872..7054b7e971 100644
--- a/src/ui/ozone/platform/wayland/extensions/webos/host/webos_shell_surface_wrapper.cc
+++ b/src/ui/ozone/platform/wayland/extensions/webos/host/webos_shell_surface_wrapper.cc
@@ -134,6 +134,7 @@ bool WebosShellSurfaceWrapper::Initialize() {
   static const wl_webos_shell_surface_listener webos_shell_surface_listener = {
       WebosShellSurfaceWrapper::StateChanged,
       WebosShellSurfaceWrapper::PositionChanged,
+      WebosShellSurfaceWrapper::ClientSizeChanged,
       WebosShellSurfaceWrapper::Close, WebosShellSurfaceWrapper::Exposed,
       WebosShellSurfaceWrapper::StateAboutToChange};
 
@@ -258,6 +259,14 @@ void WebosShellSurfaceWrapper::PositionChanged(
   NOTIMPLEMENTED_LOG_ONCE();
 }
 
+void WebosShellSurfaceWrapper::ClientSizeChanged(
+    void* data,
+    wl_webos_shell_surface* webos_shell_surface,
+    int32_t width,
+    int32_t height) {
+  NOTIMPLEMENTED_LOG_ONCE();
+}
+
 void WebosShellSurfaceWrapper::Close(
     void* data,
     wl_webos_shell_surface* webos_shell_surface) {
diff --git a/src/ui/ozone/platform/wayland/extensions/webos/host/webos_shell_surface_wrapper.h b/src/ui/ozone/platform/wayland/extensions/webos/host/webos_shell_surface_wrapper.h
index 964c5fae0b..873a2add17 100644
--- a/src/ui/ozone/platform/wayland/extensions/webos/host/webos_shell_surface_wrapper.h
+++ b/src/ui/ozone/platform/wayland/extensions/webos/host/webos_shell_surface_wrapper.h
@@ -67,6 +67,11 @@ class WebosShellSurfaceWrapper : public WaylandShellSurfaceWrapper {
                               wl_webos_shell_surface* webos_shell_surface,
                               int32_t x,
                               int32_t y);
+  // Called to notify a client that the surface size is changed.
+  static void ClientSizeChanged(void* data,
+                              wl_webos_shell_surface* webos_shell_surface,
+                              int32_t width,
+                              int32_t height);
   // Called by the compositor to request closing of the window.
   static void Close(void* data, wl_webos_shell_surface* webos_shell_surface);
   // Called to notify a client which surface areas are now exposed (visible).
-- 
2.37.3.windows.1


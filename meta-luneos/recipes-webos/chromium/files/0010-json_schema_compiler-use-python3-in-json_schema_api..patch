From 98bf76350869e39807ae91bb3a23c78d2e8ce3c6 Mon Sep 17 00:00:00 2001
From: Takuto Ikuta <tikuta@chromium.org>
Date: Wed, 19 May 2021 11:38:04 +0000
Subject: [PATCH] json_schema_compiler: use python3 in json_schema_api.gni

Fixed: 1205586
Change-Id: Ia23e52b7f6dc2bb7cd450e7a2621587bf17c3e3c
Reviewed-on: https://chromium-review.googlesource.com/c/chromium/src/+/2905170
Auto-Submit: Takuto Ikuta <tikuta@chromium.org>
Commit-Queue: Nico Weber <thakis@chromium.org>
Reviewed-by: Nico Weber <thakis@chromium.org>
Cr-Commit-Position: refs/heads/master@{#884405}
---
 src/tools/json_schema_compiler/json_schema_api.gni | 11 +++--------
 1 file changed, 3 insertions(+), 8 deletions(-)

diff --git a/src/tools/json_schema_compiler/json_schema_api.gni b/src/tools/json_schema_compiler/json_schema_api.gni
index 16bed8b4fd..6515f73f72 100644
--- a/src/tools/json_schema_compiler/json_schema_api.gni
+++ b/src/tools/json_schema_compiler/json_schema_api.gni
@@ -36,8 +36,6 @@
 #     A specific visibility to apply for the generated static library. If
 #     omitted, visibility will be inherited from the invoker.
 
-import("//build/config/python.gni")
-
 # NOTE: Common variables here for when multiple templates use them.
 compiler_root = "//tools/json_schema_compiler"
 compiler_script = "$compiler_root/compiler.py"
@@ -112,8 +110,7 @@ template("generated_json_strings") {
 
   bundle_generator_schema_name = target_name + "_bundle_generator_schema"
 
-  # TODO(crbug.com/1112471): Get this to run cleanly under Python 3.
-  python2_action(bundle_generator_schema_name) {
+  action(bundle_generator_schema_name) {
     visibility = [ ":$root_target_name" ]
     script = compiler_script
     inputs = compiler_sources + invoker.sources
@@ -230,8 +227,7 @@ template("function_registration") {
   bundle_generator_registration_name =
       target_name + "_bundle_generator_registration"
 
-  # TODO(crbug.com/1112471): Get this to run cleanly under Python 3.
-  python2_action(bundle_generator_registration_name) {
+  action(bundle_generator_registration_name) {
     visibility = [ ":$root_target_name" ]
     script = compiler_script
     inputs = compiler_sources + invoker.sources
@@ -324,8 +320,7 @@ template("generated_types") {
 
   schema_generator_name = target_name + "_schema_generator"
 
-  # TODO(crbug.com/1112471): Get this to run cleanly under Python 3.
-  python2_action_foreach(schema_generator_name) {
+  action_foreach(schema_generator_name) {
     visibility = [ ":$root_target_name" ]
     script = compiler_script
     sources = invoker.sources

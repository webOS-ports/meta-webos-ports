From 15f11dcbf9cf1e60f4e3a67672c69bdd88deccdf Mon Sep 17 00:00:00 2001
From: Martin Jansa <martin2.jansa@lgepartner.com>
Date: Mon, 27 Mar 2023 22:27:29 +0000
Subject: [PATCH] CMakeLists.txt: replace -std=c++11 with -std=c++14

:Release Notes:
c++11 isn't compatible with googletest currently in mickledore.

:Detailed Notes:
With googletest 1.13.0 from:
https://git.openembedded.org/meta-openembedded/commit/?id=46266e59ff36b38f46a67573528cee658960c764
it fails to build with:
http://gecko.lge.com:8000/Errors/Details/564314

FAILED: Imported/gtest/CMakeFiles/gtest_main.dir/src/gtest_main.cc.o 
TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot-native/usr/bin/x86_64-webos-linux/x86_64-webos-linux-g++  -ITOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/git/src -ITOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/git/include/public/ls2-helpers -ITOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/lib/glib-2.0/include -ITOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/git/include/public -isystem TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/src/gtest/include -isystem TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/src/gtest -m64 -march=core2 -mtune=core2 -msse3 -mfpmath=sse -fstack-protector-strong  -O2 -D_FORTIFY_SOURCE=2 -Wformat -Wformat-security -Werror=format-security -Werror=return-type  --sysroot=TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot  -O2 -pipe -g -feliminate-unused-debug-types -fmacro-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/git=/usr/src/debug/ls2-helpers/1.0.0-1-r3  -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/git=/usr/src/debug/ls2-helpers/1.0.0-1-r3  -fmacro-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/build=/usr/src/debug/ls2-helpers/1.0.0-1-r3  -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/build=/usr/src/debug/ls2-helpers/1.0.0-1-r3  -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot=  -fmacro-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot=  -fdebug-prefix-map=TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot-native=  -fvisibility-inlines-hidden  -std=c++11 -Wall -Wextra -fno-permissive -Wno-unused-parameter -Wno-type-limits, -Wno-missing-field-initializers -Werror=return-type -Werror=reorder -Werror=uninitialized -Wl,--no-undefined -ITOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/lib/glib-2.0/include -DUSE_PMLOG_DECLARATION -ITOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/include/glib-2.0 -ITOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/lib/glib-2.0/include -DNDEBUG -Wall -Wshadow -Wno-error=dangling-else -DGTEST_HAS_PTHREAD=1 -fexceptions -Wextra -Wno-unused-parameter -Wno-missing-field-initializers -MD -MT Imported/gtest/CMakeFiles/gtest_main.dir/src/gtest_main.cc.o -MF Imported/gtest/CMakeFiles/gtest_main.dir/src/gtest_main.cc.o.d -o Imported/gtest/CMakeFiles/gtest_main.dir/src/gtest_main.cc.o -c TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/src/gtest/src/gtest_main.cc
In file included from TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/include/gtest/gtest-message.h:57,
                 from TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/include/gtest/gtest-assertion-result.h:46,
                 from TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/include/gtest/gtest.h:64,
                 from TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/src/gtest/src/gtest_main.cc:32:
TOPDIR/BUILD/work/qemux86_64-webos-linux/ls2-helpers/1.0.0-1-r3/recipe-sysroot/usr/include/gtest/internal/gtest-port.h:270:2: error: #error C++ versions less than C++14 are not supported.
  270 | #error C++ versions less than C++14 are not supported.
      |  ^~~~~

:Testing Performed:
Only build tested.

:QA Notes:
No change to image.

:Issues Addressed:
[WRP-412] Create GPVB with Yocto 4.2 Mickledore
[WRP-12233] googletest-1.13.0 no longer supports -std=c++11 and older

Change-Id: I19e28f7ab38ecfbfe248d657506e237e8b648a5b
---
Upstream-Status: Submitted [http://gpro.lge.com/c/webosose/ls2-helpers/+/349896 CMakeLists.txt: replace -std=c++11 with -std=c++14]

 CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index c311076..38e8d23 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -35,7 +35,7 @@ if(WEBOS_USE_WERROR)
 endif()
 
 # Turn on all warnings
-webos_add_compiler_flags(ALL -std=c++11 -Wall -Wextra -fno-permissive)
+webos_add_compiler_flags(ALL -std=c++14 -Wall -Wextra)
 #disable specific warnings
 webos_add_compiler_flags(ALL -Wno-unused-parameter -Wno-type-limits, -Wno-missing-field-initializers)
 #promote specific warnings to errors

From 7ab0caa6451c12a352edefb4fb0ed1ff222fbb2e Mon Sep 17 00:00:00 2001
From: Christophe Chapuis <chris.chapuis@gmail.com>
Date: Mon, 24 Jul 2017 17:53:33 +0000
Subject: [PATCH] Disable some sandboxing capabilities

LuneOS is running on old kernels (< 3.8), so disable some sandboxing
functionalities that can be problematic.

Signed-off-by: Christophe Chapuis <chris.chapuis@gmail.com>
---
 src/core/content_browser_client_qt.cpp | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/src/core/content_browser_client_qt.cpp b/src/core/content_browser_client_qt.cpp
index 5f441f2..10ee72d 100644
--- a/src/core/content_browser_client_qt.cpp
+++ b/src/core/content_browser_client_qt.cpp
@@ -511,6 +511,10 @@ void ContentBrowserClientQt::AppendExtraCommandLineSwitches(base::CommandLine* c
     std::string processType = command_line->GetSwitchValueASCII(switches::kProcessType);
     if (processType == switches::kZygoteProcess)
         command_line->AppendSwitchASCII(switches::kLang, GetApplicationLocale());
+
+    // LuneOS is running on old kernels (< 3.8), so disable some sandboxing functionalities that can be problematic
+    command_line->AppendSwitch(switches::kDisableSeccompFilterSandbox);
+    command_line->AppendSwitch(switches::kDisableNamespaceSandbox);
 }
 
 void ContentBrowserClientQt::GetAdditionalWebUISchemes(std::vector<std::string>* additional_schemes)
-- 
2.7.4

